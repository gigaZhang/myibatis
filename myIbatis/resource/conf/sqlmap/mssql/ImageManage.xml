<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
	PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
	"http://www.ibatis.com/dtd/sql-map-2.dtd">
<!-- 该XLM为UserDaoImpl类相对应的数据库操作-->
<sqlMap>

	<insert id="insertImageManage" parameterClass="com.freemarker.entity.ImageManage">  
		insert into DD_IMAGES(di_tpid,di_tgid,di_refid,di_filename,di_filedesc,di_comment,di_size,di_time,di_width,di_height) values (#di_tpid#,#di_tgid#,#di_refid#,#di_filename#,#di_filedesc#,#di_comment#,#di_size#,getDate(),#di_width#,#di_height#)
	</insert>
	
	<update id="updateImageManage" parameterClass="com.freemarker.entity.ImageManage">
		update DD_IMAGES
		<dynamic prepend="SET">
			<isNotEmpty prepend="," property="di_tpid">di_tpid = #di_tpid# </isNotEmpty>
			<isNotEmpty prepend="," property="di_tgid">di_tgid = #di_tgid# </isNotEmpty>
			<isNotEmpty prepend="," property="di_refid">di_refid = #di_refid# </isNotEmpty>
			<isNotEmpty prepend="," property="di_filename">di_filename = #di_filename# </isNotEmpty>
			<isNotEmpty prepend="," property="di_comment">di_comment = #di_comment# </isNotEmpty>
			<isNotEmpty prepend="," property="di_filedesc">di_filedesc = #di_filedesc# </isNotEmpty>
		</dynamic>
		 where di_id = #di_id#
	</update>
	
	<select id="listSplitImageManage"  parameterClass="java.util.Map" resultClass="com.freemarker.entity.ImageManage">  
		mst_sp_pageshow 'di_id,di_tpid,di_tgid,di_refid,di_filename,di_filedesc,di_comment,di_size,di_time,di_width,di_height', 'DD_IMAGES', '$search$', 'di_id', 'di_id DESC', 30, $page$
	</select>
	
	<select id="getImageManageCount"  parameterClass="java.util.Map" resultClass="java.lang.Integer">  
		SELECT COUNT(*) FROM DD_IMAGES where $search2$
	</select>
	
	<update id="deleteGroupImageManage" parameterClass="java.util.Map">
		update DD_IMAGES set di_valid = 0 where di_id = #di_id#
	</update>
	
	<select id="getImageManage"  parameterClass="java.util.Map" resultClass="com.freemarker.entity.ImageManage">  
		SELECT top 1 $rows$ FROM DD_IMAGES where $search$
	</select>

</sqlMap>